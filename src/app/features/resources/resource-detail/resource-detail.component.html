<app-page-container classNames="font-roboto tracking-normal bg-white dark:bg-gray-800 text-sw-dark-blue dark:text-gray-100 pb-20">
  <div class="my-16">
    <a
      [routerLink]="backLink()"
      class="inline-flex items-center dark:text-gray-300 hover:underline dark:hover:no-underline dark:hover:text-sw-yellow transition-colors duration-200"
    >
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
      </svg>
      {{ definition?.detail?.backLabel ?? 'Back to list' }}
    </a>
  </div>

  <app-loading-state *ngIf="isLoading" [message]="definition?.detail?.loadingMessage ?? 'Loading...'">
  </app-loading-state>

  <app-error-state *ngIf="!isLoading && errorMessage" [message]="errorMessage" (retry)="retry()"></app-error-state>

  <div *ngIf="!isLoading && !errorMessage && item">

    <!-- LIGHT THEME -->
    <ng-container *ngIf="!themeService.isDark()">

      <!-- Headline -->
      <div class="text-center mb-28">
        <p class="font-light text-2xl leading-8 mb-5">{{ kicker() }}</p>
        <div class="mx-auto border border-sw-dark-blue w-14 h-0"></div>
        <h1 class="font-bold text-7xl leading-tight mt-2.5 mb-0.5">
          {{ title() }}
        </h1>
        <p *ngIf="subtitle()" class="font-light text-lg leading-6 mt-3">{{ subtitle() }}</p>
      </div>

      <div class="flex flex-col lg:flex-row gap-8">

        <div class="flex-1 order-2 lg:order-1">
          <!-- Details Section -->
          <h2 class="font-bold text-2xl leading-7 mb-6">Details:</h2>
          <div class="space-y-0">
            <div *ngFor="let field of fields()" class="text-lg leading-6">
              <span class="font-bold">{{ field.label }}: </span><span>{{ field.value(item) }}</span>
            </div>
          </div>

          <!-- Related Sections -->
          <div class="mt-8" *ngFor="let rel of related">

            <!-- Single Related Item -->
            <ng-container *ngIf="rel.block.kind === 'single' && rel.single">
              <div class="mt-6 flex items-center">
                <h3 class="font-bold text-lg leading-6 mr-1">{{ rel.block.title }}:</h3>
                <a
                  [routerLink]="rel.block.link(rel.single)"
                  class="flex-none bg-sw-platinum hover:bg-sw-silver font-bold text-sm leading-tight rounded-sm transition-colors duration-200 py-5 px-7"
                >
                  {{ rel.block.label(rel.single) }}
                </a>
              </div>
            </ng-container>

            <!-- List of Related Items -->
            <ng-container *ngIf="rel.block.kind === 'list' && rel.list.length > 0">
              <div class="mt-10">
                <h2 class="font-bold text-2xl leading-8 mb-4">{{ rel.block.title }}:</h2>
                <div class="flex flex-wrap gap-4">
                  <a
                    *ngFor="let relatedItem of rel.list"
                    [routerLink]="rel.block.link(relatedItem)"
                    class="bg-sw-platinum hover:bg-sw-dark-platinum font-bold text-sm leading-tight rounded-sm transition-colors duration-200 py-5 px-7"
                  >
                    {{ rel.block.label(relatedItem) }}
                  </a>
                </div>
              </div>
            </ng-container>
          </div>
        </div>

        <div class="flex-1 flex items-start justify-center lg:justify-end order-1 lg:order-2">
          <div class="w-full relative overflow-hidden aspect-[28/15]">
            <img [src]="item.imageUrl" [alt]="title()" (error)="onImageError($event)" class="w-full h-full object-cover" />
          </div>
        </div>

      </div>

    </ng-container>


    <!-- DARK THEME -->
    <div *ngIf="themeService.isDark()" class="bg-sw-dark-blue dark:bg-sw-dark-blue rounded-lg shadow-xl overflow-hidden transition-colors duration-300">

      <!-- Headline -->
      <div class="bg-sw-brandy dark:bg-sw-brandy text-white text-center py-6 transition-colors duration-300">
        <p class="text-sm uppercase tracking-wide text-sw-yellow mb-2">{{ kicker() }}</p>
        <h1 class="text-3xl md:text-4xl font-bold">{{ title() }}</h1>
        <p *ngIf="subtitle()" class="mt-2 text-sm text-white">{{ subtitle() }}</p>
      </div>

      <div class="flex flex-col lg:flex-row gap-8 p-6 md:p-10">

        <div class="flex-1 space-y-6 order-2 lg:order-1">
          <!-- Details Section -->
          <h2 class="text-2xl font-bold mb-4">Details:</h2>
          <div class="space-y-3">
            <div *ngFor="let field of fields()" class="flex border-b border-gray-300 dark:border-gray-700 pb-2">
              <span class="font-semibold dark:text-gray-400 w-40">{{ field.label }}:</span>
              <span class="dark:text-gray-200">{{ field.value(item) }}</span>
            </div>
          </div>

          <!-- Related Sections -->
          <div class="mt-6" *ngFor="let rel of related">

            <!-- Single Related Item -->
            <ng-container *ngIf="rel.block.kind === 'single' && rel.single">
              <h3 class="text-xl font-bold mb-3">{{ rel.block.title }}:</h3>
              <a
                [routerLink]="rel.block.link(rel.single)"
                class="inline-block dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 font-semibold py-2 px-4 rounded-lg transition-colors duration-200 shadow-sm border border-gray-200 dark:border-gray-600"
              >
                {{ rel.block.label(rel.single) }}
              </a>
            </ng-container>
          </div>
        </div>

        <div class="flex-1 flex items-center justify-center order-1 lg:order-2">
          <div class="w-full max-w-md">
            <img [src]="item.imageUrl" [alt]="title()" (error)="onImageError($event)" class="w-full h-auto rounded-lg shadow-2xl" />
          </div>
        </div>
      </div>

      <div *ngFor="let rel of related" class="px-6 md:px-10 pb-10">

        <!-- List of Related Items -->
        <ng-container *ngIf="rel.block.kind === 'list' && rel.list.length > 0">
          <h2 class="text-2xl font-bold mb-6">{{ rel.block.title }}:</h2>

          <div appDragScroll class="flex w-full max-w-full gap-4 overflow-x-auto overflow-y-hidden pb-4 scroll-smooth snap-x snap-mandatory scrollbar-hide">
            <a
              *ngFor="let relatedItem of rel.list"
              [routerLink]="rel.block.link(relatedItem)"
              class="snap-start flex-shrink-0 w-64 bg-gray-300 dark:bg-gray-800 rounded-lg overflow-hidden shadow-none hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-800"
            >
              <div class="h-32 overflow-hidden">
                <img
                  *ngIf="(rel.block.image ? getRelatedImageUrl(rel.block, relatedItem) : '') as img"
                  [src]="img"
                  [alt]="rel.block.label(relatedItem)"
                  class="w-full h-full object-cover"
                />
              </div>
              <div class="p-4">
                <p *ngIf="rel.block.subtitle" class="text-xs text-sw-dark-blue/70 dark:text-gray-400 mb-1">{{ rel.block.subtitle(relatedItem) }}</p>
                <h4 class="font-bold">{{ rel.block.label(relatedItem) }}</h4>
              </div>
            </a>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</app-page-container>
