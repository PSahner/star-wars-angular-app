<!-- People Detail Container -->
<app-page-container classNames="bg-sw-white dark:bg-gray-900 text-sw-black dark:text-sw-white mb-[80px]">

  <!-- Back Button -->
  <div class="my-[63.5px]">
    <a
      routerLink="/charaktere"
      class="inline-flex items-center dark:text-gray-300 hover:text-sw-yellow transition-colors duration-200"
    >
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
      </svg>
      Zurück zur Übersicht
    </a>
  </div>

  <!-- Loading State -->
  <app-loading-state *ngIf="isLoading" message="Lade Charakterdetails..."></app-loading-state>

  <!-- Error State -->
  <app-error-state *ngIf="!isLoading && errorMessage" [message]="errorMessage" (retry)="retry()"></app-error-state>

  <!-- Character Detail Content -->
  <div *ngIf="!isLoading && !errorMessage && person">

    <!-- LIGHT MODE LAYOUT (Default) -->
    <ng-container *ngIf="!themeService.isDark()">
      <!-- Heading -->
      <div class="text-center mt-[87.5px] mb-[109px]">
        <!-- Text above main text -->
        <p class="font-roboto font-light text-[25px] leading-[30px] tracking-normal mb-[20.5px]">Charakterdetails</p>

        <!-- Separator -->
        <div class="mx-auto border border-sw-black w-[53px] h-0"></div>

        <!-- Main Text -->
        <h1 class="font-roboto font-bold text-[75px] leading-[90px] tracking-normal mt-[9.5px] mb-[2px]">
          {{ person.name }}
        </h1>
      </div>

      <!-- Main Content Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

        <!-- Left Column: Details -->
        <div>
          <h2 class="font-roboto font-bold text-[25px] leading-[28px] mb-6">Details:</h2>

          <!-- Detail Items -->
          <div class="space-y-0">
            <div class="grid grid-cols-[140px_1fr] py-1">
              <span class="font-roboto font-bold text-[18px] leading-[23px] text-sw-black">Größe:</span>
              <span class="font-roboto font-normal text-[18px] leading-[23px] text-sw-black">{{ person.height !== 'unknown' ? person.height + ' cm' : 'Unbekannt' }}</span>
            </div>

            <div class="grid grid-cols-[140px_1fr] py-1">
              <span class="font-roboto font-bold text-[18px] leading-[23px] text-sw-black">Gewicht:</span>
              <span class="font-roboto font-normal text-[18px] leading-[23px] text-sw-black">{{ person.mass !== 'unknown' ? person.mass + ' kg' : 'Unbekannt' }}</span>
            </div>

            <div class="grid grid-cols-[140px_1fr] py-1">
              <span class="font-roboto font-bold text-[18px] leading-[23px] text-sw-black">Haarfarbe:</span>
              <span class="font-roboto font-normal text-[18px] leading-[23px] capitalize">{{ person.hair_color }}</span>
            </div>

            <div class="grid grid-cols-[140px_1fr] py-1">
              <span class="font-roboto font-bold text-[18px] leading-[23px] text-sw-black">Augenfarbe:</span>
              <span class="font-roboto font-normal text-[18px] leading-[23px] capitalize">{{ person.eye_color }}</span>
            </div>

            <div class="grid grid-cols-[140px_1fr] py-1">
              <span class="font-roboto font-bold text-[18px] leading-[23px] text-sw-black">Geburtsjahr:</span>
              <span class="font-roboto font-normal text-[18px] leading-[23px] text-sw-black">{{ person.birth_year }}</span>
            </div>

            <div class="grid grid-cols-[140px_1fr] py-1">
              <span class="font-roboto font-bold text-[18px] leading-[23px] text-sw-black">Geschlecht:</span>
              <span class="font-roboto font-normal text-[18px] leading-[23px] text-sw-black">{{ translateGender(person.gender) }}</span>
            </div>
          </div>

          <!-- Homeworld Section -->
          <div class="mt-6 flex items-center" *ngIf="homeworld">
            <h3 class="font-roboto font-bold text-[18px] leading-[23px] w-[140px]">Heimatplanet:</h3>
            <a
              [routerLink]="['/planeten', getHomeworldId()]"
              class="inline-block bg-sw-gray hover:bg-sw-gray-hover font-roboto font-bold text-[14px] leading-[17px] rounded-[1px] transition-colors duration-200 py-[19px] px-[29px]"
            >
              {{ homeworld.name }}
            </a>
          </div>

           <!-- Movies Section (Light Mode) -->
          <div class="mt-10" *ngIf="films.length > 0">
            <h2 class="font-roboto font-bold text-[25px] leading-[30px] mb-4">Filme:</h2>
            <div class="flex flex-wrap gap-4">
              <div *ngFor="let film of films">
                <!-- Note: Assuming simple text button for movies in light mode based on "styled like Heimatplanet entry" -->
                 <button
                  class="bg-sw-gray hover:bg-sw-gray-hover font-roboto font-bold text-[14px] leading-[17px] rounded-[1px] transition-colors duration-200 py-[19px] px-[29px]"
                >
                  {{ film.title }}
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column: Image -->
        <div class="flex items-start justify-center lg:justify-end">
           <!-- 50% width effectively handled by grid column, aspect ratio 28:15 -->
          <div class="w-full relative overflow-hidden aspect-[28/15]">
            <img
              [src]="person.imageUrl"
              [alt]="person.name"
              (error)="onImageError($event)"
              class="w-full h-full object-cover"
            />
          </div>
        </div>
      </div>
    </ng-container>

    <!-- DARK MODE LAYOUT -->
    <div *ngIf="themeService.isDark()" class="bg-sw-gray/[0.24] dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden transition-colors duration-300">

        <!-- Header -->
        <div class="bg-sw-black dark:bg-sw-black text-sw-white text-center py-6 transition-colors duration-300">
          <p class="text-sm uppercase tracking-wide text-sw-yellow mb-2">Charakterdetails</p>
          <h1 class="text-3xl md:text-4xl font-bold">{{ person.name }}</h1>
        </div>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 p-6 md:p-10">

          <!-- Left Column: Details -->
          <div class="space-y-6">
            <h2 class="text-2xl font-bold mb-4">Details:</h2>

            <!-- Detail Items -->
            <div class="space-y-3">
              <div class="flex border-b border-gray-300 dark:border-gray-700 pb-2">
                <span class="font-semibold dark:text-gray-400 w-40">Größe:</span>
                <span class="dark:text-gray-200">{{ person.height !== 'unknown' ? person.height + ' cm' : 'Unbekannt' }}</span>
              </div>

              <div class="flex border-b border-gray-300 dark:border-gray-700 pb-2">
                <span class="font-semibold dark:text-gray-400 w-40">Gewicht:</span>
                <span class="dark:text-gray-200">{{ person.mass !== 'unknown' ? person.mass + ' kg' : 'Unbekannt' }}</span>
              </div>

              <div class="flex border-b border-gray-300 dark:border-gray-700 pb-2">
                <span class="font-semibold dark:text-gray-400 w-40">Haarfarbe:</span>
                <span class="dark:text-gray-200 capitalize">{{ person.hair_color }}</span>
              </div>

              <div class="flex border-b border-gray-300 dark:border-gray-700 pb-2">
                <span class="font-semibold dark:text-gray-400 w-40">Augenfarbe:</span>
                <span class="dark:text-gray-200 capitalize">{{ person.eye_color }}</span>
              </div>

              <div class="flex border-b border-gray-300 dark:border-gray-700 pb-2">
                <span class="font-semibold dark:text-gray-400 w-40">Geburtsjahr:</span>
                <span class="dark:text-gray-200">{{ person.birth_year }}</span>
              </div>

              <div class="flex border-b border-gray-300 dark:border-gray-700 pb-2">
                <span class="font-semibold dark:text-gray-400 w-40">Geschlecht:</span>
                <span class="dark:text-gray-200">{{ translateGender(person.gender) }}</span>
              </div>
            </div>

            <!-- Homeworld Section -->
            <div class="mt-6" *ngIf="homeworld">
              <h3 class="text-xl font-bold mb-3">Heimatplanet:</h3>
              <a
                [routerLink]="['/planeten', getHomeworldId()]"
                class="inline-block dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 font-semibold py-2 px-4 rounded-lg transition-colors duration-200 shadow-sm border border-gray-200 dark:border-gray-600"
              >
                {{ homeworld.name }}
              </a>
            </div>
          </div>

          <!-- Right Column: Image -->
          <div class="flex items-center justify-center">
            <div class="w-full max-w-md">
              <img
                [src]="person.imageUrl"
                [alt]="person.name"
                (error)="onImageError($event)"
                class="w-full h-auto rounded-lg shadow-2xl"
              />
            </div>
          </div>
        </div>

        <!-- Films Section -->
        <div *ngIf="films.length > 0" class="px-6 md:px-10 pb-10">
          <h2 class="text-2xl font-bold mb-6">Filme:</h2>

          <!-- Horizontal Scrollable Film Cards -->
          <div appDragScroll class="flex w-full max-w-full gap-4 overflow-x-auto overflow-y-hidden pb-4 scroll-smooth snap-x snap-mandatory scrollbar-hide">
            <div
              *ngFor="let film of films"
              class="snap-start flex-shrink-0 w-64 dark:bg-gray-700 rounded-lg overflow-hidden shadow-none hover:shadow-lg transition-shadow duration-300 border border-gray-200 dark:border-gray-600"
            >
              <div class="h-32 bg-gray-300 dark:bg-gray-600 overflow-hidden">
                <img
                  [src]="film.imageUrl"
                  [alt]="film.title"
                  class="w-full h-full object-cover"
                />
              </div>
              <div class="p-4">
                <p class="text-xs text-sw-black/70 dark:text-gray-400 mb-1">Episode {{ film.episode_id }}</p>
                <h4 class="font-bold">{{ film.title }}</h4>
                <p class="text-sm text-sw-black/80 dark:text-gray-300 mt-1">{{ film.release_date | date: 'dd.MM.yyyy' }}</p>
              </div>
            </div>
          </div>
        </div>
    </div>
  </div>

</app-page-container>
