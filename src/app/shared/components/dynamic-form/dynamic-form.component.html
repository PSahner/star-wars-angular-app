<form [formGroup]="form" class="w-full" (ngSubmit)="$event.preventDefault()">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-x-5 gap-y-4">
    <ng-container *ngFor="let field of fields">
      <div [ngClass]="isFullWidth(field) ? 'md:col-span-2' : ''">
        <div class="flex items-center gap-2">
          <label
            class="flex-1 min-w-0 font-roboto font-medium text-sm leading-tight tracking-normal text-sw-navy-blue dark:text-gray-200"
            [attr.for]="field.key"
          >
            <span>{{ field.label }}</span>
          </label>
        </div>

        <div class="mt-2">
          <input
            *ngIf="field.type === 'text' || field.type === 'number'"
            [type]="field.type === 'number' ? 'number' : 'text'"
            [id]="field.key"
            class="w-full bg-gray-100 dark:bg-gray-800 text-sw-dark-blue dark:text-gray-100 rounded-sm dark:rounded-full px-4 py-2 border border-sw-silver dark:border-none focus:outline-none focus:ring-1 focus:ring-sw-dark-blue focus:border-sw-dark-blue dark:focus:ring-2 dark:focus:ring-sw-yellow min-h-12 placeholder:text-sw-silver dark:placeholder:text-gray-400 transition-all duration-300 hover:border-sw-dark-blue"
            [placeholder]="field.placeholder ?? ''"
            [formControlName]="field.key"
            (input)="onValueChanged()"
          />

          <textarea
            *ngIf="field.type === 'textarea'"
            [id]="field.key"
            rows="5"
            class="w-full bg-gray-100 dark:bg-gray-800 text-sw-dark-blue dark:text-gray-100 rounded-sm dark:rounded-lg px-4 py-3 border border-sw-silver dark:border-none focus:outline-none focus:ring-1 focus:ring-sw-dark-blue focus:border-sw-dark-blue dark:focus:ring-2 dark:focus:ring-sw-yellow placeholder:text-sw-silver dark:placeholder:text-gray-400 transition-all duration-300 hover:border-sw-dark-blue"
            [placeholder]="field.placeholder ?? ''"
            [formControlName]="field.key"
            (input)="onValueChanged()"
          ></textarea>

          <select
            *ngIf="field.type === 'select'"
            [id]="field.key"
            class="w-full bg-gray-100 dark:bg-gray-800 text-sw-dark-blue dark:text-gray-100 rounded-sm dark:rounded-full px-4 py-2 border border-sw-silver dark:border-none focus:outline-none focus:ring-1 focus:ring-sw-dark-blue focus:border-sw-dark-blue dark:focus:ring-2 dark:focus:ring-sw-yellow min-h-12 transition-all duration-300 hover:border-sw-dark-blue"
            [formControlName]="field.key"
            (change)="onValueChanged()"
          >
            <option value="" disabled hidden>{{ field.placeholder ?? 'Auswählen' }}</option>
            <option *ngFor="let opt of field.options ?? []" [value]="opt.value">{{ opt.label }}</option>
          </select>

          <select
            *ngIf="field.type === 'multiselect'"
            [id]="field.key"
            multiple
            class="w-full bg-gray-100 dark:bg-gray-800 text-sw-dark-blue dark:text-gray-100 rounded-sm dark:rounded-lg px-4 py-2 border border-sw-silver dark:border-none focus:outline-none focus:ring-1 focus:ring-sw-dark-blue focus:border-sw-dark-blue dark:focus:ring-2 dark:focus:ring-sw-yellow min-h-12 transition-all duration-300 hover:border-sw-dark-blue"
            [formControlName]="field.key"
            (change)="onValueChanged()"
          >
            <option *ngFor="let opt of field.options ?? []" [value]="opt.value">{{ opt.label }}</option>
          </select>

          <p *ngIf="field.type === 'multiselect'" class="mt-2 text-xs text-sw-dark-blue/60 dark:text-gray-400">
            {{ field.placeholder ?? 'Mehrfachauswahl möglich' }}
          </p>
        </div>
      </div>
    </ng-container>
  </div>
</form>
